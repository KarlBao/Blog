---
layout: default_post
---

整理了一段用于创建一般`jQuery`插件的通用模板，提供了`对象封装`、`公共接口调用`和`AMD模块加载`功能。


### 代码

```javascript
(function(factory){
  if(typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module depending on jQuery.
    define(['jquery'], factory);
  }
  else {
    // No AMD. Register plugin with global jQuery object.
    factory(jQuery);
  }
})(function($) {
  var plugin = 'demoPlugin'; // set your plugin name here
  
  $[plugin] = function(el,opts) {
    var defaults = {
      // default settings
      attr1 : 0,
      attr2 : 5
    };
    var $this = $(el);
    var settings = {};
    var __methods = {};
    $.data(el,plugin,$this);
    
    // private methods
    __methods = {
      init : function(opts) {
        // initialize plugins
        settings = $.extend({},defaults,opts);
      }
    };
    
    // public methods
    $this.methods = {
      foo : function(arg1) {},
      bar : function(arg1,arg2) {}
    };

    __methods.init(opts);
  }
  
  $.fn[plugin] = function(options) {
    if (options === undefined) { options = {}; }
    
    if (typeof options === 'object') {
      return this.each(function(index, el) {
        new $[plugin](el, options);
      });
    }
    else if(this.data(plugin).methods[options]) {
      return this.data(plugin).methods[options].apply(this, Array.prototype.slice.call( arguments, 1 ));
    }
    else {
      $.error( 'Method ' +  options + ' does not exist on jQuery.'+plugin );
    } 
  }
});
```

编写新的插件时，只需要将以上`plugin`变量的值换成插件名称即可。

### 使用

使用默认设置初始化插件：

```javascript
$selector.demoPlugin();
```


使用自定义设置(`options`)初始化插件：

```javascript
$selector.demoPlugin({ attr1:2 });
```

以上代码初始化插件并将默认值`attr1 = 0`覆盖。


在插件初始化之后，调用此插件的公共方法`foo`：

```javascript
$selector.demoPlugin('foo');
```

如果调用的公共方法需要传入参数，则将参数值随方法名之后传入：

```javascript
$selector.demoPlugin('foo','arg1');
```

以上代码调用公共方法`foo`，并传入参数`arg1`。

### 地址

如果对此插件有任何改进或建议， 可以到[这里](https://gist.github.com/KarlBao/e46b5da8e767a7fe858398254744727d)Comment或者Fork。